# TradingAgents å¾®æœåŠ¡æµ‹è¯•å¥—ä»¶

è¿™ä¸ªæµ‹è¯•å¥—ä»¶ç”¨äºæµ‹è¯• TradingAgents å¾®æœåŠ¡æ¶æ„çš„æ‰€æœ‰ç»„ä»¶ï¼ŒåŒ…æ‹¬ API Gatewayã€Analysis Engine å’Œ Data Serviceã€‚

## ğŸ“‹ æµ‹è¯•æ–‡ä»¶è¯´æ˜

### 1. `quick_api_test.py` - å¿«é€Ÿ API æµ‹è¯•
- **ç”¨é€”**: å¿«é€Ÿæµ‹è¯•æ‰€æœ‰å¾®æœåŠ¡çš„åŸºæœ¬åŠŸèƒ½
- **ç‰¹ç‚¹**: è½»é‡çº§ï¼Œè¿è¡Œæ—¶é—´çŸ­ï¼ˆ1-2åˆ†é’Ÿï¼‰
- **æµ‹è¯•å†…å®¹**:
  - æœåŠ¡å¥åº·æ£€æŸ¥
  - è‚¡ç¥¨ä¿¡æ¯æŸ¥è¯¢
  - åŸºæœ¬é¢æ•°æ®æŸ¥è¯¢
  - è‚¡ç¥¨æ–°é—»æŸ¥è¯¢
  - æ•°æ®æºçŠ¶æ€
  - æ¨¡å‹é…ç½®

### 2. `test_microservices_integration.py` - é›†æˆæµ‹è¯•
- **ç”¨é€”**: å®Œæ•´çš„å¾®æœåŠ¡é›†æˆæµ‹è¯•
- **ç‰¹ç‚¹**: åŠŸèƒ½å…¨é¢ï¼ŒåŒ…å«åˆ†æå·¥ä½œæµæµ‹è¯•
- **æµ‹è¯•å†…å®¹**:
  - æ‰€æœ‰å¿«é€Ÿæµ‹è¯•é¡¹ç›®
  - å®Œæ•´çš„è‚¡ç¥¨åˆ†æå·¥ä½œæµ
  - åˆ†æè¿›åº¦ç›‘æ§
  - è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Š

### 3. `run_tests.py` - æµ‹è¯•è¿è¡Œå™¨
- **ç”¨é€”**: ç»Ÿä¸€çš„æµ‹è¯•å…¥å£
- **æ”¯æŒå‚æ•°**:
  - `--type quick`: åªè¿è¡Œå¿«é€Ÿæµ‹è¯•
  - `--type integration`: åªè¿è¡Œé›†æˆæµ‹è¯•
  - `--type all`: è¿è¡Œæ‰€æœ‰æµ‹è¯•

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å‰ææ¡ä»¶

1. **å¯åŠ¨å¾®æœåŠ¡**:
   ```bash
   # å¯åŠ¨åŸºç¡€æœåŠ¡
   cd backend
   docker-compose -f docker-compose.local.yml up -d
   
   # å¯åŠ¨åº”ç”¨æœåŠ¡ï¼ˆéœ€è¦åœ¨è™šæ‹Ÿç¯å¢ƒä¸­ï¼‰
   # ç»ˆç«¯1: Data Service
   cd data-service
   python -m uvicorn app.main:app --host 0.0.0.0 --port 8002 --reload
   
   # ç»ˆç«¯2: Analysis Engine  
   cd analysis-engine
   python -m uvicorn app.main:app --host 0.0.0.0 --port 8001 --reload
   
   # ç»ˆç«¯3: API Gateway
   cd api-gateway
   python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
   ```

2. **å®‰è£…æµ‹è¯•ä¾èµ–**:
   ```bash
   pip install -r backend/tests/requirements.txt
   ```

### è¿è¡Œæµ‹è¯•

#### æ–¹æ³•1: ä½¿ç”¨æµ‹è¯•è¿è¡Œå™¨ï¼ˆæ¨èï¼‰

```bash
# å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰
python backend/tests/run_tests.py --type quick

# é›†æˆæµ‹è¯•ï¼ˆåŒ…å«åˆ†æå·¥ä½œæµï¼Œè€—æ—¶è¾ƒé•¿ï¼‰
python backend/tests/run_tests.py --type integration

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python backend/tests/run_tests.py --type all
```

#### æ–¹æ³•2: ç›´æ¥è¿è¡Œæµ‹è¯•æ–‡ä»¶

```bash
# å¿«é€Ÿæµ‹è¯•
python backend/tests/quick_api_test.py

# é›†æˆæµ‹è¯•
python backend/tests/test_microservices_integration.py
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåä¼šç”Ÿæˆ JSON æ ¼å¼çš„æµ‹è¯•æŠ¥å‘Šï¼š

- **å¿«é€Ÿæµ‹è¯•æŠ¥å‘Š**: `backend/tests/quick_test_report_YYYYMMDD_HHMMSS.json`
- **é›†æˆæµ‹è¯•æŠ¥å‘Š**: `backend/tests/test_report_YYYYMMDD_HHMMSS.json`

æŠ¥å‘ŠåŒ…å«ï¼š
- æµ‹è¯•æ€»ç»“ï¼ˆæ€»æ•°ã€é€šè¿‡æ•°ã€å¤±è´¥æ•°ã€æˆåŠŸç‡ï¼‰
- è¯¦ç»†çš„æµ‹è¯•ç»“æœ
- å“åº”æ—¶é—´ç»Ÿè®¡
- æ—¶é—´æˆ³ä¿¡æ¯

## ğŸ”§ æµ‹è¯•é…ç½®

### æœåŠ¡ç«¯ç‚¹é…ç½®

é»˜è®¤çš„æœåŠ¡ç«¯ç‚¹ï¼š
- **API Gateway**: http://localhost:8000
- **Analysis Engine**: http://localhost:8001
- **Data Service**: http://localhost:8002

å¦‚éœ€ä¿®æ”¹ï¼Œè¯·ç¼–è¾‘æµ‹è¯•æ–‡ä»¶ä¸­çš„ `base_urls` é…ç½®ã€‚

### æµ‹è¯•æ•°æ®

é»˜è®¤æµ‹è¯•ä½¿ç”¨çš„è‚¡ç¥¨ä»£ç ï¼š
- **Aè‚¡**: 000858 (äº”ç²®æ¶²)
- **ç¾è‚¡**: AAPL (è‹¹æœ)

å¯ä»¥åœ¨æµ‹è¯•æ–‡ä»¶ä¸­ä¿®æ”¹è¿™äº›é»˜è®¤å€¼ã€‚

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è¿æ¥å¤±è´¥**:
   - ç¡®ä¿æ‰€æœ‰å¾®æœåŠ¡éƒ½å·²å¯åŠ¨
   - æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
   - ç¡®è®¤é˜²ç«å¢™è®¾ç½®

2. **æµ‹è¯•è¶…æ—¶**:
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤æ•°æ®æº API å¯†é’¥é…ç½®æ­£ç¡®
   - å¢åŠ è¶…æ—¶æ—¶é—´è®¾ç½®

3. **åˆ†æå·¥ä½œæµå¤±è´¥**:
   - æ£€æŸ¥ LLM é…ç½®ï¼ˆDeepSeek API å¯†é’¥ï¼‰
   - ç¡®è®¤æ•°æ®æºè¿æ¥æ­£å¸¸
   - æŸ¥çœ‹æœåŠ¡æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

### è°ƒè¯•å»ºè®®

1. **æŸ¥çœ‹æœåŠ¡æ—¥å¿—**:
   ```bash
   # æŸ¥çœ‹ Docker æœåŠ¡æ—¥å¿—
   docker-compose -f docker-compose.local.yml logs
   
   # æŸ¥çœ‹åº”ç”¨æœåŠ¡æ—¥å¿—ï¼ˆåœ¨å„è‡ªçš„ç»ˆç«¯ä¸­ï¼‰
   ```

2. **æ‰‹åŠ¨æµ‹è¯• API**:
   ```bash
   # å¥åº·æ£€æŸ¥
   curl http://localhost:8000/health
   curl http://localhost:8001/health  
   curl http://localhost:8002/health
   
   # è‚¡ç¥¨ä¿¡æ¯
   curl http://localhost:8000/api/stock/info/000858
   ```

3. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**:
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   netstat -ano | findstr :8000
   netstat -ano | findstr :8001
   netstat -ano | findstr :8002
   ```

## ğŸ“ æ‰©å±•æµ‹è¯•

å¦‚éœ€æ·»åŠ æ–°çš„æµ‹è¯•ç”¨ä¾‹ï¼š

1. åœ¨ç›¸åº”çš„æµ‹è¯•ç±»ä¸­æ·»åŠ æ–°çš„æµ‹è¯•æ–¹æ³•
2. éµå¾ªç°æœ‰çš„å‘½åçº¦å®šï¼š`test_åŠŸèƒ½åç§°`
3. ä½¿ç”¨ `log_test_result` æ–¹æ³•è®°å½•æµ‹è¯•ç»“æœ
4. æ›´æ–°æ­¤ README æ–‡æ¡£

## ğŸ†• Data Service ä¸“é¡¹æµ‹è¯•å¥—ä»¶

### ğŸ“‹ æ–°å¢æµ‹è¯•æ–‡ä»¶

1. **`test_data_service.py`** - Data Serviceå…¨é¢åŠŸèƒ½æµ‹è¯•
   - âœ… å¥åº·æ£€æŸ¥ã€è‚¡ç¥¨ä¿¡æ¯ã€å†å²æ•°æ®ã€æ–°é—»è·å–
   - âœ… ç¼“å­˜åŠŸèƒ½ã€é”™è¯¯å¤„ç†ã€åˆ†æIDè¿½è¸ªæµ‹è¯•

2. **`test_data_service_performance.py`** - Data Serviceæ€§èƒ½æµ‹è¯•
   - âš¡ å¹¶å‘æµ‹è¯•ã€è´Ÿè½½æµ‹è¯•ã€å‹åŠ›æµ‹è¯•
   - ğŸ“Š å“åº”æ—¶é—´ç»Ÿè®¡ã€QPSæµ‹é‡

3. **`run_data_service_tests.py`** - Data Serviceç»Ÿä¸€æµ‹è¯•è¿è¡Œå™¨
   - ğŸ” æœåŠ¡å¯ç”¨æ€§æ£€æŸ¥ã€é›†æˆæµ‹è¯•ã€è¾¹ç•Œæƒ…å†µæµ‹è¯•
   - ğŸ“„ è‡ªåŠ¨ç”ŸæˆJSONæµ‹è¯•æŠ¥å‘Š

4. **`quick_test_data_service.py`** - Data Serviceå¿«é€Ÿæµ‹è¯•
   - ğŸš€ 5åˆ†é’Ÿå†…å®Œæˆæ ¸å¿ƒåŠŸèƒ½éªŒè¯

5. **`debug_data_service.py`** - Data Serviceè°ƒè¯•æµ‹è¯•
   - ğŸ” è¯¦ç»†çš„è¯·æ±‚å“åº”è°ƒè¯•ä¿¡æ¯

6. **`test_post_request.py`** - POSTè¯·æ±‚ä¸“é¡¹æµ‹è¯•
   - ğŸ¯ ä¸“é—¨æµ‹è¯•POST /api/stock/dataæ¥å£

7. **`test_analysis_engine_concurrency.py`** - Analysis Engineå¹¶å‘æµ‹è¯•
   - âš¡ æµ‹è¯•å¤šè‚¡ç¥¨åŒæ—¶åˆ†æçš„å¹¶å‘æ€§èƒ½
   - ğŸ“Š å¹¶å‘åŠ é€Ÿæ¯”å’Œæ€§èƒ½è¯„ä¼°
   - ğŸ” å¹¶å‘é—®é¢˜è¯Šæ–­å’Œé”™è¯¯åˆ†æ

### ğŸš€ Data Serviceæµ‹è¯•å¿«é€Ÿå¼€å§‹

```bash
# å¿«é€ŸéªŒè¯Data ServiceåŠŸèƒ½
cd backend/tests
python quick_test_data_service.py

# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
python run_data_service_tests.py
```

### âš¡ Analysis Engineå¹¶å‘æµ‹è¯•

```bash
# æµ‹è¯•Analysis Engineå¹¶å‘æ€§èƒ½
cd backend/tests
python test_analysis_engine_concurrency.py
```

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒï¼š
- [Data Serviceæµ‹è¯•æ–‡æ¡£](README_data_service_tests.md)
- [å¹¶å‘æµ‹è¯•æŒ‡å—](README_concurrency_testing.md)

## ğŸ¯ æœ€ä½³å®è·µ

1. **å®šæœŸè¿è¡Œæµ‹è¯•**: åœ¨ä»£ç å˜æ›´åè¿è¡Œå¿«é€Ÿæµ‹è¯•
2. **CI/CD é›†æˆ**: å°†æµ‹è¯•é›†æˆåˆ°æŒç»­é›†æˆæµç¨‹ä¸­
3. **ç›‘æ§æµ‹è¯•ç»“æœ**: å…³æ³¨æµ‹è¯•æˆåŠŸç‡å’Œå“åº”æ—¶é—´è¶‹åŠ¿
4. **åŠæ—¶ä¿®å¤å¤±è´¥**: æµ‹è¯•å¤±è´¥æ—¶åŠæ—¶è°ƒæŸ¥å’Œä¿®å¤é—®é¢˜
5. **ä½¿ç”¨ä¸“é¡¹æµ‹è¯•**: é’ˆå¯¹ç‰¹å®šæœåŠ¡ä½¿ç”¨å¯¹åº”çš„ä¸“é¡¹æµ‹è¯•å¥—ä»¶
